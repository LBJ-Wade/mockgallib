#
# mock_galaxy_library/lib
#

LIBRARY   = libmockgal.a libmockgal.dylib

all: $(LIBRARY)

CPPFLAGS := -O2
LIBS     := -lm -lgsl -lgslcblas -lhdf5

# options
CPPFLAGS += -DDEBUG


# add non standark library path if necessary
DIR_PATH := # e.g. /opt/gsl

CFLAGS   += $(foreach dir, $(DIR_PATH), -I$(dir)/include)
LIBS     += $(foreach dir, $(DIR_PATH), -L$(dir)/lib)

OBJS     := msg.o cosmology.o growth.o
OBJS     += power.o sigma.o mf.o mf_cumulative.o
OBJS     += hod.o nbar.o nbar_fitting.o
OBJS     += lightcone.o catalogue.o satellite.o
OBJS     += corr_projected.o kdtree.o hdf5_read.o
OBJS     += sky.o distance.o remap.o slice.o 
OBJS     += cola_file.o halo_mass.o halo_concentration.o

libmockgal.a: $(OBJS)
	ar r $@ $(OBJS)

libmockgal.dylib: $(OBJS)
	$(CXX) -dynamiclib $(LIBS) $(OBJS) -o $@



.PHONY: clean dependence
clean:
	rm -f $(LIBRARY) $(OBJS)

dependence:
	g++ -MM -MG *.cpp

# dependence generated by `make dependence`
catalogue.o: catalogue.cpp msg.h hod.h catalogue.h particle.h kdtree.h \
  lightcone.h halo.h satellite.h sky.h util.h mf_cumulative.h mf.h \
  sigma.h power.h
cola_file.o: cola_file.cpp cola_file.h halo.h
corr_projected.o: corr_projected.cpp msg.h catalogue.h particle.h \
  kdtree.h hod.h lightcone.h halo.h corr_projected.h hist2d.h
cosmology.o: cosmology.cpp cosmology.h const.h
distance.o: distance.cpp msg.h cosmology.h distance.h
growth.o: growth.cpp cosmology.h
halo_concentration.o: halo_concentration.cpp msg.h cosmology.h \
  halo_concentration.h power.h sigma.h halo.h
halo_mass.o: halo_mass.cpp msg.h util.h halo_mass.h
hdf5_read.o: hdf5_read.cpp msg.h halo.h hdf5_io.h lightcone.h
hdf5_write.o: hdf5_write.cpp halo.h hdf5_io.h lightcone.h
hod.o: hod.cpp hod.h
kdtree.o: kdtree.cpp particle.h kdtree.h
lightcone.o: lightcone.cpp util.h sky.h halo.h lightcone.h remap.h \
  slice.h cola_file.h distance.h halo_mass.h halo_concentration.h \
  power.h sigma.h
mf.o: mf.cpp mf.h const.h
mf_cumulative.o: mf_cumulative.cpp const.h cosmology.h growth.h mf.h \
  sigma.h power.h mf_cumulative.h
msg.o: msg.cpp msg.h
nbar.o: nbar.cpp msg.h const.h cosmology.h growth.h power.h sigma.h mf.h \
  hod.h nbar.h
nbar_fitting.o: nbar_fitting.cpp msg.h cosmology.h nbar.h power.h sigma.h \
  mf.h hod.h nbar_fitting.h
power.o: power.cpp power.h msg.h
remap.o: remap.cpp msg.h remap.h halo.h util.h
satellite.o: satellite.cpp msg.h cosmology.h particle.h halo.h \
  satellite.h
sigma.o: sigma.cpp const.h sigma.h power.h cosmology.h
sky.o: sky.cpp msg.h cosmology.h sky.h halo.h util.h
slice.o: slice.cpp slice.h halo.h
